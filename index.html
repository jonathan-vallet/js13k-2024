<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>13 steps to death</title><style>body,
      html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
        width: 100%;
      }

      #game {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      #gameBackgroundCanvas {
        position: absolute;
        top: -5%;
        left: -5%;
        width: 110%;
        height: 110%;
        z-index: -1; /* Behind the main canvas */
        object-fit: cover;
        filter: blur(15px) brightness(50%); /* Apply blur and darken the background */
      }</style></head><body><div id="game"><canvas id="gameBackgroundCanvas"></canvas><canvas id="uiCanvas"></canvas><canvas id="gameCanvas"></canvas></div><script>!function(){"use strict";const e={letters:{1:"010110010010111",2:"01101001001001001111",3:"11100001001100011110",4:"00110101100111110001",5:"11111000111100011110",6:"01101000111010010110",7:"11110001001000100010",8:"01101001011010010110",9:"01101001011100010110",0:"01101001100110010110",A:"01101001111110011001",B:"110101110101110",C:"011100100100011",D:"110101101101110",E:"111100111100111",F:"111100111100100",G:"01111000101110010110",H:"10011001111110011001",I:"111010010010111",J:"00010001000110010110",K:"10011010110010101001",L:"100100100100111",M:"1000111011101011000110001",N:"10011101101110011001",O:"01101001100110010110",P:"11101001111010001000",Q:"01101001100110100101",R:"11101001111010101001",S:"01111000011000011110",T:"111010010010010",U:"10011001100110010110",V:"1000110001010100101000100",W:"1010110101101010101001010",X:"10011001011010011001",Y:"10011001111100011110",Z:"11110001011010001111"," ":"000000000000000",",":"000000000001001",".":"000000000000001","!":"010010010000010","/":"0000100010001000100010000",":":"000010000010000",x:"000000101010101"},defaultOptions:{x:0,y:0,text:"",vspacing:10,hspacing:2,color:"rgb(255,255,255)"},textLine:function(e){let M=0;for(let t=0;t<e.text.length;t++){const r=e.text.charAt(t),l=this.letters[r]||this.letters.unknown,n=l.length/5;for(let r=0;r<5;r++)for(let o=0;o<n;o++){"1"===l[r*n+o]&&e.ctx.rect((e.x+(o+M+e.hspacing*t))*A,(e.y+r)*A,A,A)}M+=n}},text:function(M){const t={ctx:u,...this.defaultOptions,...M},r=t.text.split("\n"),l=5*A;t.ctx.beginPath();for(let M=0;M<r.length;M++){const n=r[M],o=t.x,i=t.y+(l+t.vspacing*A)*M;e.textLine({ctx:t.ctx,x:o,y:i,text:n,hspacing:t.hspacing})}t.ctx.fillStyle=t.color,t.ctx.fill()}},M={blueGreen:["#024d53","#599dbc","#72d1c7","#a9ffe6"],crate:["#000","#893a25","#f89e61","#863422"],green:["#000","#527f67","#a2ce69","#d6f8e1"],sand:["#cab168","#e5d09e"],bronze:["#000","#811c07","#ca6137","#ffb59c"]},t={arrow:{rle:"16LKZLA\\K^LZLBZLBZLLLLLLLLLLLLG",colors:M.blueGreen},block:{rle:"16AXNAMYezeYNZnZNedeNqeYlYeqNqeYgNgYeqNqeYfMeYMfYeqNqeYfMeYMfYeqNqeYeMfZMeYeqNqeYeMeNYMeYeqNqeYeNfNeYeqNqeYlYeqNedeNZnZNYezeYMAXNA",colors:M.blueGreen},characters:{rle:"144FPKQLPLLLLLLLLJNhNGNiNHNhNJPKQLPLPKQLPIMlMEMmMFMlMGNhNGNiNHNhNHNhNGNiNHNhNGMlMEMmMFMlMFMlMEMmMFMlMFMlMEMmMFMlMFMlMEMmMFMlMFMlMEMmMFMlMFMlMEMmMFMlMFMesereMEMeugMFMlMFMlMEMmMFMlMFMlMEMmMFMlMEMqeveqMEMufNEMqlqMEMereseMEMeugMFMlMFMereseMEMeugMFMlMFMrMrMrMFMqMseMqMFMlMEMqeveqMEMufNEMqlqMDMqeveqMEMufNEMqlqMFMqMrMqMGMqMuMHMjMGMrMrMrMFMqMseMqMFMlMFMrMrMrMFMqMseMqMFMlMFOtOGMtNHOtOFNqMrMqNFMqMuMHNhNGNqMrMqNFMqMuMHNhNFM[P[MGPYMGM[P[MDMZMtMZMFMtNHMZPZMEMZMtMZMFMtOGMZPZMDMZMZrZMZMFN[MFMZM^MZMCOYPYMYqMEQYNFMqM^OCMqYMYPYOFQ[MEO^MqMCMZM^MZMFMYMZMFMZM^MZMCMrM]NqMDMr\\MqMFN]MrMCMqN]MrMEMqNZMYqMEMrM]NEMqTqMGMYMqNGMqTqMEUANEO\\MHUDNAUGN\\MqMFUGN^NHOqMIN^NHMqNZMISHMZNqMIMZNqMJSIMqNZMHMrNrMIMrNJMrNrMJOrMHMrNrMHMrOJMrOJMrNrMJOrMJPKQLPLLLLLLLLJNhNGNiNHNhNJPKQLPLPKQLPIMlMEMmMFNjNGNhNGNiNHNhNHNhNGNiNHNhNGMlMEMmMFMlMFMlMEMmMFNjNFMlMEMmMFNjNFMgqhMEMmMFMlMFMlMEMmMFMlMFMlMEMmMFMlMFMeveMEMerjMFMlMFMgqhMEMmMFMlMFMgqhMEMmMFMlMEMqeveqMEMshMeMDMqlqMEMeveMEMerjMFMlMFMeveMEMerjMFMlMFMeqMrMqeMFMqMqgMqMeMDMgNgMEMqeveqMEMshMeMDMqlqMDMqeveqMEMshMeMDMqlqMFMqMrMqMGMqMqfrMfMEMeMfMeMGMeqMrMqeMFMqMqgMqMeMDMgNgMFMeqMrMqeMFMqMqgMqMeMDMgNgMGNtNHMtNfMFNhNHMqMrMqMGMqMqfrMfMEMeMfMeMHMqMrMqMGMqMqfrMfMEMeMfMeMGMZPZMHSeMEMYMhMYMFMYMtMYMGMtNfMEMYMhMYMFMYMtMYMGMtNfMEMYMhMYMFM[r[MGMYNYMANFMZMfMZMFMYQYNHSfMDMYMgPFNYQYMGTfMDMYNgOEMqN\\NqMFMZMqMHMqNYNYNqMEO\\MrMFMZqNqODMrNeQEMrM\\OGM[MrOEQeNrMCMrN\\NrMFMYMqMGMrN\\NrMCMrM\\PFMsPFPYNYMrMDP\\MrMEMqMZNqMFMrMYNYPDOrNrOGMrNHOrNrOEOqNrMIOYqMIMrNqOGMrNqOGMrNYNGOqNrMIMqNqMKMqMLMqNqMKOqMJMqNqMJMqOKMqOJMqOqMKOqME",colors:["#000","#e42c37","#c07548","#fdcbb0"]},crate:{rle:"16AXNANYnYOZVZNeNeqjNeNeMfqetfMeNeMfteqfMeNeNjqeNeNZVZOYnYOYXYO[MZM]OYNYMYNYPYNYMZMYNYMZMYNYPYNYMYNYO]MZM[NAXNA",colors:M.crate},flag:{rle:"48DYLCYLCYLBZLBZLBZLCMgLMlGMlGMkHMkHMkHMkHMkHMkHMkHMkHMkHMkHMlGMkHMFfGMLCMChHMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLCMLBZLBZLBZK",colors:M.bronze},"gong-trigger":{rle:"16XQsevesNqfTfqNfOhNgNfNeteNfNfMeqPqeMfMAMeMeqMrMqeMeMBMeMeqPqeMeMBMeNeteNeMBMeMAMhMAMeMBMeMBPBMeMBMeMHMeMBMeMHMeMBMeMAQBMeMBMeMBQAMeMBOHOA",colors:M.bronze},gong:{rle:"16F\\JZtZGYfvYEZe^rYC\\jYrYB[lYqYBZnZBYhthYBYgq\\qgYBYgqYrYqgYBYgq\\qgYBZgtgZBeZlZeCeZjZeEe`eGlD",colors:M.bronze},"hole-filled":{rle:"16LLLAMANAMFXNANYnYOZVZNeNeqjNeNeMfqetfMeNeMfteqfMeNeNjqeNeNZVZOYnYOYXYMAM[MZM]MCMAYMYNYNAMLF",colors:M.crate},hole:{rle:"16LLLYA\\AYGbEYA`AYDdCYAbAYB\\MYNYM\\A\\MYMZMYM\\AZMYMYNYMYMZCZTZCZMYRYMZCZTZEYTYHRLI",colors:["#000","#00506e"]},"key-holder":{rle:"16LFdCYpYAZ{e\\qbe\\qYeYhYeYe\\qZfZfZe\\qYgZgYe\\qYgYhYe\\qZfZfZe\\qYeYhYeYe\\qbe\\oq[edqZpfYAdZA",colors:M.blueGreen},key:{rle:"16FtKqPqIqMhMqHqMYNeMqHqMYNeMqHqM\\MqIqNYMqJqMeYMqJqNYMqJqMZMqKqNqLArLLLLLK",colors:M.green},lock:{rle:"16FPKMtMIMq\\qMGMZhYqMEMZeqNYeYqMCNYeqPYeYqMAOYeqPYeYrPYfqNYfYrO[eqNYeYfqMYM\\ereYgMYAYM\\fYgMYCYM[MYgMYEYMYMfYeMYGYMhMYIYPYK\\F",colors:M.green},rock:{rle:"16FPIOhNFMeresfMDMerYeueMCMfqZesfqMBMgqZgYfMBMiYgZNBNYkZqNBNYiZsMBMqgriqMAMqeqYgqMYgMAMYfqMYeqMYgMAMZeqMYfNYfMAOZNYPYMqBPEOLF",colors:M.blueGreen},sand:{rle:"16ZMYV]MYV]MYW\\MYMYU^MYU^MZU^MZV]MYV]XM\\XM\\X[XN[XM\\X]XZ",colors:M.sand},"spawn-current":{rle:"16E\\LBYAYJZBYAYJZAYAYJYAYBYBYD[F[AYAYEZCYBZAZB\\AYB\\BYA\\BZAZBYCZEYAYA[F[DYBYBYAYJYAYAZJYAYBZJYAYLB\\E",colors:M.blueGreen},spawn:{rle:"32E\\L\\LBYAYLAYAYJZBYAYIZBYAYJZAYAYJZAYAYJYAYBYBYGYAYBYBYD[F[AYB[F[AYAYEfCYBYAYErCYBZAZBhAYB[AZBtAYB\\BYAhBZA[BYAtBZAZBYCfEYAYBYCrEYAYA[F[BYA[F[DYBYBYAYGYBYBYAYJYAYAZJYAYAZJYAYBZIYAYBZJYAYLAYAYLB\\L\\E",colors:M.blueGreen},trap:{rle:"16DNANANGVEQfQCNYM[N[NBMeMfYfMfMeMANZM\\e\\OeMfMYgMfMeO]N]OgNgMeYgN\\eYM]eYOeMeOgYfNAeZN[M[MeBNYeMgMfOCO[fZNFQfMJPF",colors:["#306710","#000","#b1712e"]}},r=["arrow","key-holder","rock","gong-trigger"],l=16,n=13,o=20,i=10,c=200,Y=225,a=0,s=1,N=2,f=3,q=document.getElementById("uiCanvas"),h=q.getContext("2d"),g=document.getElementById("gameCanvas"),u=g.getContext("2d"),Z=document.getElementById("gameBackgroundCanvas"),x=Z.getContext("2d");let A=1,F=0,d=[],L=[{tile:"arrow",x:4,y:7},{tile:"arrow",x:4,y:6,orientation:f},{tile:"arrow",x:2,y:4,orientation:f},{tile:"trap",x:15,y:6},{tile:"trap",x:12,y:6},{tile:"hole",x:12,y:5},{tile:"crate",x:3,y:6},{tile:"crate",x:4,y:6},{tile:"crate",x:11,y:6},{tile:"rock",x:11,y:2},{tile:"rock",x:1,y:3},{tile:"rock",x:2,y:3},{tile:"rock",x:3,y:3},{tile:"rock",x:4,y:3},{tile:"rock",x:5,y:3},{tile:"rock",x:6,y:3},{tile:"rock",x:7,y:3},{tile:"rock",x:12,y:3},{tile:"rock",x:13,y:3},{tile:"rock",x:14,y:3},{tile:"rock",x:15,y:3},{tile:"rock",x:16,y:3},{tile:"rock",x:17,y:3},{tile:"rock",x:18,y:3},{tile:"rock",x:4,y:4},{tile:"rock",x:5,y:4},{tile:"rock",x:14,y:4},{tile:"rock",x:16,y:4},{tile:"rock",x:1,y:5},{tile:"rock",x:2,y:5},{tile:"rock",x:5,y:5},{tile:"rock",x:14,y:5},{tile:"rock",x:16,y:5},{tile:"rock",x:14,y:6},{tile:"rock",x:16,y:6},{tile:"rock",x:14,y:7},{tile:"rock",x:16,y:7},{tile:"block",x:8,y:3,orientation:f},{tile:"block",x:9,y:3,orientation:f},{tile:"flag",x:9,y:2},{tile:"block",x:10,y:3,color:M.green,orientation:f,isPushable:!0},{tile:"lock",x:11,y:3},{tile:"key-holder",x:15,y:4},{tile:"key",x:15,y:4},{tile:"gong-trigger",x:1,y:4},{tile:"gong",x:15,y:7},{tile:"spawn-current",x:9,y:7}],y=(...e)=>E(k(...e)),E=(...e)=>{let M=w.createBufferSource(),t=w.createBuffer(e.length,e[0].length,m);return e.map(((e,M)=>t.getChannelData(M).set(e))),M.buffer=t,M.connect(w.destination),M.start(),M},k=(e=1,M=.05,t=220,r=0,l=0,n=.1,o=0,i=1,c=0,Y=0,a=0,s=0,N=0,f=0,q=0,h=0,g=0,u=1,Z=0,x=0)=>{let A,F,d=2*Math.PI,L=c*=500*d/m**2,y=(0<q?1:-1)*d/4,E=t*=(1+2*M*Math.random()-M)*d/m,k=[],w=0,C=0,O=0,b=1,G=0,p=0,H=0;for(Y*=500*d/m**3,q*=d/m,a*=d/m,s*=m,N=m*N|0,F=(r=99+m*r)+(Z*=m)+(l*=m)+(n*=m)+(g*=m)|0;O<F;k[O++]=H)++p%(100*h|0)||(H=o?1<o?2<o?3<o?Math.sin((w%d)**3):Math.max(Math.min(Math.tan(w),1),-1):1-(2*w/d%2+2)%2:1-4*Math.abs(Math.round(w/d)-w/d):Math.sin(w),H=(N?1-x+x*Math.sin(2*Math.PI*O/N):1)*(0<H?1:-1)*Math.abs(H)**i*e*B*(O<r?O/r:O<r+Z?1-(O-r)/Z*(1-u):O<r+Z+l?u:O<F-g?(F-O-g)/n*u:0),H=g?H/2+(g>O?0:(O<F-g?1:(F-O)/g)*k[O-g|0]/2):H),A=(t+=c+=Y)*Math.sin(C*q-y),w+=A-A*f*(1-1e9*(Math.sin(O)+1)%2),C+=A-A*f*(1-1e9*(Math.sin(O)**2+1)%2),b&&++b>s&&(t+=a,E+=a,b=0),!N||++G%N||(t=E,c=L,b=b||1);return k},B=.3,m=44100,w=new(window.AudioContext||webkitAudioContext),C=[];function O(e){const M=function(e){const M="A".charCodeAt(0),t=[],r=parseInt(e.match(/^\d+/)[0],10);e=e.replace(/^\d+/,"");for(let r=0;r<e.length;++r){const l=e[r].charCodeAt(0)-M,n=Math.floor(l/12),o=l%12+1;t.push(...Array(o).fill(n))}return{pixels:t,imageWidth:r}}(t[e].rle);C=M.pixels;const r=function(e,M){const t=[];for(let r=0;r<e.length;r+=M)t.push(e.slice(r,r+M));return t}(M.pixels,M.imageWidth),l=function(e,M,t){const r=[],l=e.length,n=e[0].length;for(let o=0;o<l;o+=t)for(let l=0;l<n;l+=M){const n=[];for(let r=0;r<t;r++)n.push(e[o+r].slice(l,l+M));r.push(n)}return r}(r,16,16);return l}function b(e,M){return e>=1&&e<o-1&&M>=1&&M<i-1}!function(){for(const e in t)t[e].tiles=O(e)}();const G=JSON.parse(JSON.stringify(L));function p(){L=JSON.parse(JSON.stringify(G)),L.forEach((e=>{t[e.tile].tiles.length>1&&(e.animationFrame=0,e.elapsed=0),e.isBeingRemoved=!1,e.scale=1})),ne=Me,oe=te,Ee(N),re=1,de=0,d=[]}function H(e,M,t=[]){let r=null;for(const l of L)l.x===e&&l.y===M&&(t.length>0?t.includes(l.tile)&&(r=l):r=l);return r}function P(e,M=null,t=null){L=L.filter((r=>r.tile!==e||null!==M&&null!==t&&(r.x!==M||r.y!==t)))}function J(e,M,t){T=e,S=e.x,X=e.y,j=S+M,R=X+t,z=0}function D(e,M,t,r){v("block",e,M);const l=e+t,n=M+r,o=H(l,n)?.tile;if("block"===o){const e=L.find((e=>e.x===l&&e.y===n&&"block"===e.tile));if(e){const M=e.orientation||a;let t=0,r=0;M===f?t=-1:M===s?t=1:M===a?r=-1:M===N&&(r=1),setTimeout((()=>{D(l,n,t,r)}),120)}}}function v(e,M=null,t=null,r,l=Y){L.filter((r=>r.tile===e&&(null===M||r.x===M&&r.y===t))).forEach((e=>{e.isBeingRemoved=!0,e.scale=1,e.elapsed=0,e.removalDuration=l,e.removeCallback=r}))}function I(){!function(){h.fillStyle="#333",h.fillRect(0,0,q.width,q.height),e.text({ctx:h,x:10,y:7,text:"STEPS:",color:"rgb(255,255,255)"});let M=0,r=0;if(de>=10){const e=de-9;M=K(e),r=K(e)}e.text({ctx:h,x:44+M,y:7+r,text:`${de}`,color:Q(de)});const l=t.key.tiles[0],n=t.key.colors||["#000","#f00","#0f0","#00f"];$(l,n,4.5,.2,{context:h}),e.text({ctx:h,x:90,y:7,text:`x${F}`,color:"rgb(255,255,255)"}),e.text({ctx:h,x:270,y:7,text:"R: RESET",color:"rgb(255,255,255)"})}()}function K(e){const M=.5*e;return Math.random()*M-M/2}function Q(e){return e<11?"rgb(255, 255, 255)":e<12?"rgb(255, 255, 0)":e<13?"rgb(255, 165, 0)":"rgb(255, 0, 0)"}let S,X,j,R,T=null,z=0;const V=200;function U(e,M,t,r,l){let n=!1;switch(l?.tile){case"crate":(function(e,M,t,r){const l=e+t,n=M+r,o=H(l,n)?.tile||null;if(b(l,n)&&(null===o||["arrow","hole","trap","hole-filled"].includes(o)))for(const l of L)if(l.x===e&&l.y===M&&"crate"===l.tile)return J(l,t,r),Oe("crate"),!0;return!1})(e,M,t,r)&&(n=!0);break;case"key":n=!0,P("key"),F++;break;case"lock":F>0&&(n=!0,v("lock",e,M,(()=>{F--})));break;case"flag":return p(),!1;case"block":const o=L.find((t=>t.x===e&&t.y===M&&"block"===t.tile));if(o){const l=o.orientation||a;o.isPushable&&(l===f&&-1===t||l===s&&1===t||l===a&&-1===r||l===N&&1===r)&&(D(e,M,t,r),n=!0)}break;case"gong-trigger":l.triggered||(l.triggered=!0,n=!0,v("gong"))}return n}function W(){u.drawImage(Z,0,0,g.width,g.height),function(e){e.forEach((e=>{const M=t[e.tile];r.includes(e.tile)||$(M.tiles[e.animationFrame||0],e.color||t[e.tile].colors,e.x,e.y,{orientation:e.orientation||a,scale:e.scale||1})}))}(L),I(),function(){const e=t.characters.tiles[Ne],M=t.characters.colors;$(e,M,ne,oe,{scale:re,flipHorizontally:le===s})}()}function $(e,M,t,r,n={}){const{orientation:o=a,scale:i=e.scale||1,context:c=u,flipHorizontally:Y=!1}=n;c.save();const s=l*A/2;c.translate((t+.5)*l*A,(r+.5)*l*A);let N=1;Y&&(N=-1),c.scale(i*N,i),c.rotate(o*Math.PI/2),c.translate(-s,-s);for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++){const l=e[t][r];l>0&&(c.fillStyle=M[l-1],c.fillRect(r*A,t*A,A,A))}c.restore()}const _=[];function ee(e){switch(e){case"ArrowUp":case"z":case"w":return"up";case"ArrowDown":case"s":return"down";case"ArrowLeft":case"q":case"a":return"left";case"ArrowRight":case"d":return"right";default:return null}}window.addEventListener("keydown",(function(e){const M=ee(e.key);M&&!_.includes(M)&&_.push(M)})),window.addEventListener("keyup",(function(e){const M=ee(e.key);if(M){const e=_.indexOf(M);-1!==e&&_.splice(e,1)}"r"===e.key&&p(),Ce=!1}));let Me=9,te=7,re=1,le=N,ne=Me,oe=te,ie=!1,ce=ne,Ye=oe,ae=ne,se=oe,Ne=0;const fe=300;let qe=0,he=!1,ge=0;const ue=400;let Ze,xe,Ae,Fe,de=0;function Le(e,M,t){if(he||ie)return;const r=ne+e,l=oe+M;let o=le;Ee(t),function(e,M,t=0,r=0){if(T||ie||he)return!1;if(!b(e,M))return Oe("wall"),!1;const l=H(e,M),n=l?.tile||null;if(l&&l.isBeingRemoved)return!1;let o=U(e,M,t,r,l);return o&&Oe(n),!![null,"arrow","key","key-holder","flag","trap","hole","hole-filled","spawn","spawn-current"].includes(n)||(o?(++de,Be(ne,oe)):Oe("wall"),!1)}(r,l,e,M)&&(de<n&&(ie=!0,ce=ne,Ye=oe,ae=r,se=l,qe=0,d.push({x:ne,y:oe,orientation:o})),de=Math.min(de+1,n))}function ye(e=null,M=null){he=!0,Ze=ne,xe=oe,Ae=e||Me,Fe=M||te,ge=performance.now()}function Ee(e){le=e,Ne=ke(le)}function ke(e){switch(e){case a:return 2;case s:case f:return 1;case N:return 0}}function Be(e,M){const t=H(e,M),r=H(ne,oe);if("trap"===t?.tile)t.tile="hole";if("hole"===r?.tile)ye(d[d.length-1].x,d[d.length-1].y),--de;de>=n&&(ye(),setTimeout((()=>{de=0}),ue))}let me=0;function we(e){!function(e){if(L.forEach((M=>{if(t[M.tile].tiles.length>1){M.elapsed=(M.elapsed||0)+e;const r=M.animationInterval||c;M.elapsed>=r&&(M.animationFrame=(M.animationFrame+1)%t[M.tile].tiles.length,M.elapsed=0)}if(M.isBeingRemoved){M.elapsed=(M.elapsed||0)+e;const t=M.removalDuration||Y;M.scale=Math.max(1-M.elapsed/t,0),M.scale<=0&&(P(M.tile,M.x,M.y),M.removeCallback&&M.removeCallback())}})),!ie&&!he&&_.length>0){switch(_[_.length-1]){case"up":Le(0,-1,a);break;case"down":Le(0,1,N);break;case"left":Le(-1,0,f);break;case"right":Le(1,0,s)}}ie&&function(e){qe+=e;const M=Math.min(qe/fe,1);ne=ce+(ae-ce)*M,oe=Ye+(se-Ye)*M;let t=ke(le);switch(Math.floor(3*M)){case 0:Ne=t+3;break;case 1:Ne=t;break;case 2:Ne=t+6}M>=1&&(ie=!1,ne=ae,oe=se,qe=0,Ne=t,Be(ce,Ye))}(e);T&&function(e){z+=e;const M=Math.min(z/V,1);T.x=S+(j-S)*M,T.y=X+(R-X)*M,M>=1&&(T.x=j,T.y=R,z=0,function(e){const M=H(e.x,e.y,["hole","trap"]);M&&(P(M.tile,e.x,e.y),P("crate",e.x,e.y),function(e,M,t,r={}){L.push({tile:e,x:M,y:t,...r})}("hole-filled",e.x,e.y),Oe("fall"))}(T),T=null)}(e)}(e-me),he&&function(){const e=performance.now()-ge,M=Math.min(e/ue,1);M<.5?(re=1-2*M,ne=Ze,oe=xe):(re=2*(M-.5),ne=Ae,oe=Fe,Ae===Me&&Fe===te&&Ee(N));M>=1&&(he=!1,ne=Ae,oe=Fe,re=1,L=L.filter((e=>"spiral"!==e.tile)))}(),W(),me=e,requestAnimationFrame(we)}let Ce=!1;function Oe(e){switch(e){case"gong-trigger":y(...[,0,523.2511,.02,,1.5,1,.5,-.05,.5,,,.3,.05,,,.05,.8,,.05]);break;case"crate":y(...[,.1,150,.05,,,,1.3,,,,,,3]);break;case"key":y(...[,0,1320,,.1,.3,1,1.82,,,880,.05]);break;case"wall":Ce||(Ce=!0,y(...[,0,440,.15,.01,.12,1,1.59,-6.98,4.97]));break;default:console.warn(`No sound effect for tile: ${e}`)}}function be(){A=Math.min(Math.floor(window.innerWidth/(o*l)),Math.floor(window.innerHeight/(i*l))),g.width=o*l*A,g.height=i*l*A,q.width=g.width,q.height=1.1*l*A,window.innerWidth/window.innerHeight>o/i?(Z.width=window.innerWidth,Z.height=window.innerWidth*(i/o)):(Z.height=window.innerHeight,Z.width=window.innerHeight*(o/i)),function(M,l){const n=t[M].tiles[0],c=t[M].colors,Y=t[l].tiles[0],a=t[l].colors;for(let e=0;e<i;e++)for(let M=0;M<o;M++){$(n,c,M,e),0!==M&&M!==o-1&&0!==e&&e!==i-1||$(Y,a,M,e);const l=H(M,e);r.includes(l?.tile)&&$(t[l.tile].tiles[0],t[l.tile].colors,M,e)}e.text({ctx:x,x:10,y:10,text:"0",color:"rgb(255,0,0)"}),x.drawImage(g,0,0,Z.width,Z.height)}("sand","rock")}u.imageSmoothingEnabled=!1,L.forEach((e=>{e.animationFrame=0})),window.addEventListener("resize",be),be(),requestAnimationFrame(we)}();</script></body></html>